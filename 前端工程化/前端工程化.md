# æ¦‚è¿°

> å‰ç«¯å·¥ç¨‹åŒ–æ˜¯æŒ‡éµå¾ªä¸€å®šæ ‡å‡†å’Œè§„èŒƒï¼Œé€šè¿‡å·¥å…·æé«˜æ•ˆç‡ã€é™ä½æˆæœ¬çš„ä¸€ç§æ‰‹æ®µ

## äº§ç”Ÿçš„åŸå› 

> å½“ä»Šå‰ç«¯åŠŸèƒ½ä¸æ–­æé«˜ï¼Œä¸šåŠ¡é€»è¾‘æ—¥ç›Šå¤æ‚

**å‰ç«¯å·¥ç¨‹åŒ–ä¸»è¦è§£å†³çš„é—®é¢˜**

- ä¼ ç»Ÿè¯­è¨€æˆ–è¯­æ³•çš„å¼Šç«¯
- æ— æ³•ä½¿ç”¨æ¨¡å—åŒ–\ç»„ä»¶åŒ–
- é‡å¤çš„æœºæ¢°å¼å·¥ä½œ
- ä»£ç é£æ ¼ç»Ÿä¸€ã€è´¨é‡ä¿è¯
- ä¾èµ–åç«¯æœåŠ¡æ¥å£æ”¯æŒ
- æ•´ä½“ä¾èµ–åç«¯é¡¹ç›®
- ...



## å·¥ç¨‹åŒ–çš„è¡¨ç°

> ä¸€åˆ‡ä»¥æé«˜æ•ˆç‡ã€é™ä½æˆæœ¬ã€è´¨é‡ä¿è¯ä¸ºç›®çš„çš„æ‰‹æ®µéƒ½å±äºâ€œå·¥ç¨‹åŒ–â€

![img](https://pic2.zhimg.com/v2-1ed6171f71105d6dfe7f71f3ef75213d_b.png)



## å·¥ç¨‹åŒ–ï¼= æŸä¸ªå·¥å…·

ç°é˜¶æ®µæœ‰ä¸€äº›å·¥å…·ååˆ†å¼ºå¤§ï¼Œæ¯”å¦‚webpackã€‚è¿™è®©å¾ˆå¤šäººè¯¯è®¤ä¸ºå·¥ç¨‹åŒ–å°±æ˜¯æŒ‡webpackï¼Œåªè¦ç”¨äº†webpackå°±ä»£è¡¨æœ‰äº†å·¥ç¨‹åŒ–ã€‚å…¶å®ä¸æ˜¯è¿™æ ·çš„ï¼Œå·¥å…·å¹¶ä¸æ˜¯å·¥ç¨‹åŒ–çš„æ ¸å¿ƒã€‚å·¥ç¨‹åŒ–çš„æ ¸å¿ƒåº”è¯¥æ˜¯é¡¹ç›®çš„æ•´ä½“è§„åˆ’æˆ–è€…æ˜¯æ¶æ„ï¼Œå·¥å…·åªæ˜¯å¸®åŠ©æˆ‘ä»¬å®ç°è¿™ç§è§„åˆ’æˆ–æ¶æ„çš„ä¸€ç§æ‰‹æ®µã€‚

![image-20220114173008332](./images/é¡¹ç›®å·¥ç¨‹åŒ–.png)



**ä¸€äº›æˆç†Ÿçš„å·¥ç¨‹åŒ–é›†æˆ**

- create-react-app
- vue-cli
- angular-cli
- gatsby-cli



# è„šæ‰‹æ¶å·¥å…·

è„šæ‰‹æ¶çš„æœ¬è´¨ä½œç”¨å°±æ˜¯åˆ›å»ºé¡¹ç›®åŸºç¡€ç»“æ„ã€æä¾›é¡¹ç›®è§„èŒƒå’Œçº¦å®šã€‚

é€šå¸¸æˆ‘ä»¬åœ¨å¼€å‘äº«ç”¨ç±»å‹çš„é¡¹ç›®éƒ½ä¼šæœ‰ä¸€äº›ç›¸åŒçš„çº¦å®šå’Œè§„èŒƒï¼ŒåŒ…æ‹¬äº†ï¼š

- ç›¸åŒçš„ç»„ç»‡ç»“æ„
- ç›¸åŒçš„å¼€å‘èŒƒå¼
- ç›¸åŒçš„æ¨¡å—ä¾èµ–
- ç›¸åŒçš„å·¥å…·é…ç½®
- ç›¸åŒçš„åŸºç¡€ä»£ç 

å¯ä»¥é€šè¿‡è„šæ‰‹æ¶å·¥å…·å¿«é€Ÿæ­å»ºç‰¹å®šç±»å‹çš„é¡¹ç›®éª¨æ¶ï¼Œç„¶ååŸºäºéª¨æ¶è¿›è¡Œå¼€å‘



## å¸¸ç”¨çš„è„šæ‰‹æ¶å·¥å…·

æ ¹æ®ä¿¡æ¯åˆ›å»ºå¯¹åº”çš„é¡¹ç›®åŸºç¡€ç»“æ„

```tex
Reacté¡¹ç›®ï¼šcreate-react-app
Vueé¡¹ç›®ï¼švue-cli
Angularï¼šangular-cli
```

æ ¹æ®ä¸€å¥—æ¨¡æ¿ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„é¡¹ç›®ç»“æ„ï¼Œæ¯”è¾ƒçµæ´»ã€æ˜“æ‰©å±•

```ts
é€šç”¨å‹é¡¹ç›®è„šæ‰‹æ¶å·¥å…·ï¼šYeoman
```

åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ç”¨äºåˆ›å»ºä¸€äº›ç‰¹å®šç±»å‹çš„æ–‡ä»¶

```ts
Plop
```

### [Yeoman](https://yeoman.io/)

> yeoman éœ€è¦æ­é…ç‰¹å®šçš„ generator ä½¿ç”¨

**å®‰è£…ï¼š** `npm install -g yo` | `yarn global add yo`

**ç”Ÿæˆä¸€ä¸ªnodemoduleçš„é¡¹ç›®**

1. å®‰è£…å¯¹åº”çš„ **generator** `generator-node`

   ```bash
   npm install -g generator-node
   ```

2. åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹å¹¶è¿›å…¥

   ```bash
   mkdir product
   cd product
   ```

3. è¿è¡Œ**generator**

   ```bash
   yo node
   ```

**åœ¨å·²æœ‰çš„é¡¹ç›®ä¹‹ä¸Šåˆ›å»ºä¸€äº›ç‰¹å®šç±»å‹çš„æ–‡ä»¶**

è¿è¡Œ **sub Generator**

```bash
yo node:cli
```

ğŸ“¢ å¹¶ä¸æ˜¯æ¯ä¸€ä¸ª generator éƒ½æä¾›å­çº§çš„ç”Ÿæˆå™¨ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£æ˜ç¡®å½“å‰ generator æ˜¯å¦æä¾›å­çº§ç”Ÿæˆå™¨

ğŸ“š **æ€»ç»“ Yeoman å¸¸è§„ä½¿ç”¨æ­¥éª¤**

1. æ˜ç¡®éœ€æ±‚
2. [æ‰¾åˆ°åˆé€‚çš„ Generator](https://yeoman.io/generators/)
3. å…¨å±€èŒƒå›´å®‰è£…æ‰¾åˆ°çš„ Generator
4. é€šè¿‡ yo è¿è¡Œå¯¹åº”çš„ Generator
5. é€šè¿‡å‘½ä»¤è¡Œäº¤äº’å¡«å†™é€‰é¡¹
6. ç”Ÿæˆæ‰€éœ€è¦çš„é¡¹ç›®ç»“æ„

![image-20220114182607641](./images/äºŒè¿›åˆ¶åŠ é€Ÿé…ç½®.png)



#### è‡ªå®šä¹‰ Generator

é€šè¿‡ä»¥ä¸Šå†…å®¹çš„äº†è§£ï¼Œæˆ‘ä»¬çŸ¥é“ä¸åŒçš„Generator å¯ä»¥ç”¨æ¥ç”Ÿæˆä¸åŒçš„é¡¹ç›®ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå·±çš„Generatoræ¥ç”Ÿæˆè‡ªå®šä¹‰çš„é¡¹ç›®ç»“æ„ã€‚

<h5 style="color: orange">åˆ›å»º Generator æ¨¡å—</h5>

> Generator æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª NPM æ¨¡å—ã€‚

**Generatoræ‹¥æœ‰ç‰¹å®šçš„ç»“æ„**: éœ€è¦åœ¨æ ¹ç›®å½•ä¸‹æœ‰ä¸€ä¸ª generators çš„æ–‡ä»¶å¤¹ï¼Œå†ä¸‹ä¸€çº§æœ‰ä¸€ä¸ªappçš„æ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾ç”Ÿæˆå™¨çš„ä»£ç ï¼Œå¦‚æœéœ€è¦æä¾›å¤šä¸ªserver generator ï¼Œå¯ä»¥åœ¨app åŒçº§ç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ªæ–°çš„ç”Ÿæˆå™¨ç›®å½•

**Yeoman çš„ Generator çš„æ¨¡å—åç§°å¿…é¡»æ˜¯ `generator-<name>` çš„æ ¼å¼**ï¼Œå¦‚æœæ²¡æœ‰é‡‡ç”¨å¯¹åº”æ ¼å¼çš„åç§°ï¼ŒYeoman åœ¨åç»­å·¥ä½œä¸­æ— æ³•æ‰¾åˆ°å½“å‰ç”Ÿæˆå™¨æ¨¡å—

![image-20220118174933640](./images/GeneratoråŸºæœ¬ç»“æ„.png)

ğŸŒ° å®ä¾‹æ¼”ç¤º

```bash
mkdir generator-sample
cd generator-sample
yarn init
# yeoman-generator æä¾›äº†ç”Ÿæˆå™¨çš„åŸºç±»ï¼Œæä¾›äº†ä¸€äº›å·¥å…·å‡½æ•°ï¼Œè®©æˆ‘ä»¬åœ¨åˆ›å»ºç”Ÿæˆå™¨çš„æ—¶å€™æ›´åŠ ä¾¿æ·
yarn add yeoman-generator
# åˆ›å»ºç›¸åº”çš„ç»“æ„
# ...
# ä¹¦å†™ app/index æ–‡ä»¶
# ...
# å°†æ¨¡å—é“¾æ¥åˆ°å…¨å±€
yarn link

# åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ç”¨æ¥æµ‹è¯•
mkdir prd
cd prd
# æµ‹è¯•: åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºäº†æ–‡ä»¶
yo sample
```

```js
// app/index æ–‡ä»¶å†…å®¹
// æ­¤æ–‡ä»¶ä½œä¸º Generator çš„æ ¸å¿ƒå…¥å£
// éœ€è¦å¯¼å‡ºä¸€ä¸ªç»§æ‰¿è‡ª Yeoman Generator çš„ç±»å‹
// Yeoman Generator åœ¨å·¥ä½œæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨æˆ‘ä»¬åœ¨æ­¤ç±»å‹ä¸­å®šä¹‰çš„ä¸€äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
// æˆ‘ä»¬åœ¨è¿™äº›æ–¹æ³•ä¸­å¯ä»¥é€šè¿‡è°ƒç”¨çˆ¶ç±»æä¾›çš„ä¸€äº›å·¥å…·æ–¹æ³•å®ç°ä¸€äº›åŠŸèƒ½ï¼Œä¾‹å¦‚æ–‡ä»¶å†™å…¥

const Generator = require('yeoman-generator')

module.exports = class extends Generator {
  writing () {
    // Yeoman è‡ªåŠ¨åœ¨ç”Ÿæˆæ–‡ä»¶é˜¶æ®µè°ƒç”¨æ­¤æ–¹æ³•
    // æˆ‘ä»¬è¿™é‡Œå°è¯•å¾€é¡¹ç›®ç›®å½•ä¸­å†™å…¥æ–‡ä»¶
    this.fs.write(
      this.destinationPath('temp.txt'), // å†™å…¥æ–‡ä»¶çš„ç»å¯¹è·¯å¾„
      Math.random().toString() // å†™å…¥æ–‡ä»¶çš„å†…å®¹
    )
  }
}
```

åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è‡ªåŠ¨åˆ›å»ºçš„æ–‡ä»¶æœ‰å¾ˆå¤šï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ¨¡æ¿åˆ›å»ºæ–‡ä»¶

<h5 style="color: orange">æ ¹æ®æ¨¡æ¿åˆ›å»ºæ–‡ä»¶</h5>

åœ¨appæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºtemplatesç›®å½•ï¼Œå°†éœ€è¦ç”Ÿæˆçš„æ–‡ä»¶éƒ½æ”¾å…¥å½“å‰æ–‡ä»¶å¤¹ä¸‹ã€‚**æ¨¡æ¿ä¸­éµå¾ª ejs çš„è¯­æ³•**

```js
// app/index æ–‡ä»¶å†…å®¹
const Generator = require('yeoman-generator')

module.exports = class extends Generator {
  writing () {
    // é€šè¿‡æ¨¡æ¿æ–¹å¼å†™å…¥æ–‡ä»¶åˆ°ç›®æ ‡ç›®å½•
    // æ¨¡æ¿æ–‡ä»¶è·¯å¾„
    const tmpl = this.templatePath('foo.txt')
    // è¾“å‡ºç›®æ ‡è·¯å¾„
    const output = this.destinationPath('foo.txt')
    // æ¨¡æ¿æ•°æ®ä¸Šä¸‹æ–‡
    const context = { title: 'Hello zce~', success: false }
    this.fs.copyTpl(tmpl, output, context)
  }
}
```

ä¹‹ååœ¨æµ‹è¯•æ–‡ä»¶å¤¹ä¸­è¿è¡Œ `yo sample` å‘½ä»¤å³å¯æµ‹è¯•å½“å‰è¾“å‡º

<h5 style="color: orange">æ¥æ”¶ç”¨æˆ·è¾“å…¥æ•°æ®</h5>

å¯¹äºæ¨¡æ¿ä¸­çš„ä¸€äº›åŠ¨æ€æ•°æ®ï¼ˆä¾‹å¦‚é¡¹ç›®çš„æ ‡é¢˜ã€åç§°ï¼‰ä¸€èˆ¬é€šè¿‡å‘½ä»¤è¡Œçš„æ–¹å¼è¯¢é—®ä½¿ç”¨è€…ä»è€Œè·å–ã€‚å®ƒçš„å®ç°åŸºäº  Generator çš„ prompting æ–¹æ³•

```js
// app/index æ–‡ä»¶å†…å®¹
const Generator = require('yeoman-generator')

module.exports = class extends Generator {
  prompting () {
    // Yeoman åœ¨è¯¢é—®ç”¨æˆ·ç¯èŠ‚ä¼šè‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•
    // åœ¨æ­¤æ–¹æ³•ä¸­å¯ä»¥è°ƒç”¨çˆ¶ç±»çš„ prompt() æ–¹æ³•å‘å‡ºå¯¹ç”¨æˆ·çš„å‘½ä»¤è¡Œè¯¢é—®
    return this.prompt([
      {
        type: 'input',
        name: 'name',
        message: 'Your project name',
        default: this.appname // appname ä¸ºé¡¹ç›®ç”Ÿæˆç›®å½•åç§°
      }
    ])
    .then(answers => {
      // answers => { name: 'user input value' }
      this.answers = answers
    })
  }
  writing () {
    // æ¨¡æ¿æ–‡ä»¶è·¯å¾„
    const tmpl = this.templatePath('bar.html')
    // è¾“å‡ºç›®æ ‡è·¯å¾„
    const output = this.destinationPath('bar.html')
    // æ¨¡æ¿æ•°æ®ä¸Šä¸‹æ–‡
    const context = this.answers

    this.fs.copyTpl(tmpl, output, context)
  }
}
```



<h3 style="color: red"> Vue Generator å®ä¾‹</h3>

1. é€šè¿‡åŸå§‹çš„æ–¹æ³•åˆ›å»ºç†æƒ³çš„é¡¹ç›®ç»“æ„ï¼Œå°†éœ€è¦é‡å¤ä½¿ç”¨çš„åŸºç¡€ä»£ç å…¨éƒ¨åŒ…å«åœ¨é‡Œé¢
2. å°è£…Generator

```bash
# 1. åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„æ–‡ä»¶
mkdir generator-vue
cd generator-vue
# 2. åˆ›å»º package.json
yarn init
# 3. å®‰è£…yeomançš„ä¾èµ–
yarn add yeoman-generator
# 4. æ‰“å¼€æ–‡ä»¶å¤¹å¹¶åˆ›å»ºä¸»å…¥å£æ–‡ä»¶
generators/app/index.js
# 5. åˆ›å»ºtemplatesæ–‡ä»¶å¤¹å¹¶å°†éœ€è¦é‡å¤ä½¿ç”¨çš„æ–‡ä»¶å…¨éƒ¨copyåˆ°é‡Œé¢
# 6. å°†æ–‡ä»¶ä¸­éœ€è¦å‘ç”Ÿå˜åŒ–çš„åœ°æ–¹é€šè¿‡æ¨¡æ¿å¼•æ“çš„è¯­æ³•è¿›è¡ŒæŒ–å‘
<%= name %>
# 7. ä¹¦å†™ generators/app/index.js
# 8. å°†å½“å‰æ¨¡å—link åˆ°å…¨å±€
yarn link
# 9. åœ¨å…¨æ–°çš„ç›®å½•ä¸‹è¿è¡Œå‘½ä»¤
yo vue
```

ğŸ“¢æ³¨æ„ï¼šå¦‚æœé‡åˆ°template æ–‡ä»¶ä¸­å«æœ‰ejs è¯­æ³•çš„å†…å®¹éœ€è¦å®Œæ•´è¾“å‡ºï¼Œåœ¨åé¢æ·»åŠ %å³å¯ã€‚ä¾‹ï¼š `<%%= BASE_URL %>`

```js
// generators/app/index.js
const Generator = require('yeoman-generator')

module.exports = class extends Generator {
  prompting () {
    return this.prompt([
      {
        type: 'input',
        name: 'name',
        message: 'Your project name',
        default: this.appname
      }
    ])
    .then(answers => {
      this.answers = answers
    })
  }

  writing () {
    // æŠŠæ¯ä¸€ä¸ªæ–‡ä»¶éƒ½é€šè¿‡æ¨¡æ¿è½¬æ¢åˆ°ç›®æ ‡è·¯å¾„

    const templates = [
      '.browserslistrc',
      '.editorconfig',
      '.env.development',
      '.env.production',
      '.eslintrc.js',
      '.gitignore',
      'babel.config.js',
      'package.json',
      'postcss.config.js',
      'README.md',
      'public/favicon.ico',
      'public/index.html',
      'src/App.vue',
      'src/main.js',
      'src/router.js',
      'src/assets/logo.png',
      'src/components/HelloWorld.vue',
      'src/store/actions.js',
      'src/store/getters.js',
      'src/store/index.js',
      'src/store/mutations.js',
      'src/store/state.js',
      'src/utils/request.js',
      'src/views/About.vue',
      'src/views/Home.vue'
    ]

    templates.forEach(item => {
      // item => æ¯ä¸ªæ–‡ä»¶è·¯å¾„
      this.fs.copyTpl(
        this.templatePath(item),
        this.destinationPath(item),
        this.answers
      )
    })
  }
}
```

<h5 style="color: orange">å‘å¸ƒ Generator</h5>

1. åˆ›å»ºgit ä»“åº“å¹¶æäº¤
2. å‘å¸ƒï¼š `yarn publish --registry=https//registry.yarnpkg.com`
3. åœ¨npm å®˜ç½‘å°±å¯ä»¥æ‰¾åˆ°å¼€å‘çš„æ¨¡å—å•¦~
4. å¦‚æœéœ€è¦è‡ªå·±çš„generator åœ¨å®˜æ–¹çš„ä»“åº“åˆ—è¡¨ä¸­å‡ºç°çš„è¯ï¼Œåœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸€ä¸ª yeoman-generator çš„å…³é”®è¯ï¼Œyeoman å®˜æ–¹å°±ä¼šå‘ç°åˆ°å½“å‰é¡¹ç›®



### Plop

> å°è€Œç¾çš„è„šæ‰‹æ¶å·¥å…·

ä¸»è¦ç”¨äºåˆ›å»ºé¡¹ç›®ä¸­ç‰¹å®šç±»å‹æ–‡ä»¶çš„å°å·¥å…·ã€‚æœ‰ç‚¹ç±»ä¼¼Yeoman ä¸­çš„ sub Generatorã€‚ä¸€èˆ¬ä¸ä¼šç‹¬ç«‹ä½¿ç”¨ï¼Œä¼šå°†å…¶é›†æˆäºé¡¹ç›®ä¸­ï¼Œç”¨æ¥è‡ªåŠ¨åŒ–åˆ›å»ºåŒç±»å‹çš„é¡¹ç›®æ–‡ä»¶

**1. å®‰è£… plop**

```bash
yarn add plop --dev
```

**2. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶** `plopfile.js`

```js
// Plop å…¥å£æ–‡ä»¶ï¼Œéœ€è¦å¯¼å‡ºä¸€ä¸ªå‡½æ•°
// æ­¤å‡½æ•°æ¥æ”¶ä¸€ä¸ª plop å¯¹è±¡ï¼Œç”¨äºåˆ›å»ºç”Ÿæˆå™¨ä»»åŠ¡

module.exports = plop => {
  // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”Ÿæˆå™¨çš„åå­—ï¼Œç¬¬äºŒä¸ªæ˜¯ç”Ÿæˆå™¨çš„é…ç½®é€‰é¡¹
  plop.setGenerator('component', {
    description: 'create a component', // ç”Ÿæˆå™¨çš„æè¿°
    prompts: [ // äº¤äº’
      {
        type: 'input',
        name: 'name',
        message: 'component name',
        default: 'MyComponent' // é»˜è®¤ç­”æ¡ˆ
      }
    ],
    actions: [ // å‘½ä»¤è¡Œäº¤äº’ä¹‹åæ‰§è¡Œçš„åŠ¨ä½œ
      {
        type: 'add', // ä»£è¡¨æ·»åŠ æ–‡ä»¶
        path: 'src/components/{{name}}/{{name}}.js',
        templateFile: 'plop-templates/component.hbs'
      },
      {
        type: 'add', // ä»£è¡¨æ·»åŠ æ–‡ä»¶
        path: 'src/components/{{name}}/{{name}}.css',
        templateFile: 'plop-templates/component.css.hbs'
      },
      {
        type: 'add', // ä»£è¡¨æ·»åŠ æ–‡ä»¶
        path: 'src/components/{{name}}/{{name}}.test.js',
        templateFile: 'plop-templates/component.test.hbs'
      }
    ]
  })
}
```

**3. ä½¿ç”¨å‘½ä»¤è¡Œæ“ä½œ**

```bash
# yarn plop <ç”Ÿæˆå™¨çš„åå­—>
yarn plop component
```

ğŸ“š æ€»ç»“ä¸€å¤

- å°† plop æ¨¡å—ä½œä¸ºé¡¹ç›®å¼€å‘ä¾èµ–å®‰è£…
- åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª plopfile.js æ–‡ä»¶
- åœ¨ plopfile.js æ–‡ä»¶ä¸­å®šä¹‰è„šæ‰‹æ¶ä»»åŠ¡
- ç¼–å†™ç”¨äºç”Ÿæˆç‰¹å®šç±»å‹æ–‡ä»¶çš„æ¨¡æ¿
- é€šè¿‡ Plop æä¾›çš„ cli è¿è¡Œè„šæ‰‹æ¶ä»»åŠ¡

## è„šæ‰‹æ¶çš„å·¥ä½œåŸç†

> è„šæ‰‹æ¶å·¥å…·å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ª node cli åº”ç”¨

å¤§éƒ¨åˆ†çš„è„šæ‰‹æ¶éƒ½æ˜¯å¯åŠ¨è¿‡åä¼šè¯¢é—®ä¸€äº›ç‰¹å®šçš„é—®é¢˜ï¼Œç„¶åå°†å›ç­”çš„å†…å®¹ç»“åˆæ¨¡æ¿æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªé¡¹ç›®çš„ç»“æ„ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡Node.js æ¥å¼€å‘ä¸€ä¸ªå°å‹è„šæ‰‹æ¶å·¥å…·ï¼š

**1. åˆ›å»ºè‡ªå®šä¹‰æ–‡ä»¶å¤¹**

```bash
mkdir scaffolding-sample
cd scaffolding-sample
```

**2. åˆå§‹åŒ– package.json**

```bash
yarn init
```

**3. æŒ‡å®š cli å…¥å£æ–‡ä»¶**

```bash
# 1. ä¿®æ”¹ package.json æ·»åŠ  bin å­—æ®µ
{
	...
	"bin": "cli.js",
	...
}

# 2. åˆ›å»º cli.js
```

```js
#!/usr/bin/env node

// Node CLI åº”ç”¨å…¥å£æ–‡ä»¶å¿…é¡»è¦æœ‰è¿™æ ·çš„æ–‡ä»¶å¤´
// å¦‚æœæ˜¯ Linux æˆ–è€… macOS ç³»ç»Ÿä¸‹è¿˜éœ€è¦ä¿®æ”¹æ­¤æ–‡ä»¶çš„è¯»å†™æƒé™ä¸º 755
// å…·ä½“å°±æ˜¯é€šè¿‡ chmod 755 cli.js å®ç°ä¿®æ”¹
console.log("cli working")
```

```bash
# test
# 1. å°†æ¨¡å—link åˆ°å…¨å±€
yarn link
# 2. ä½¿ç”¨å‘½ä»¤è¿›è¡Œæµ‹è¯•
scaffolding-sample
# è¾“å‡º"cli working"è¯´æ˜æ–‡ä»¶æ­£å¸¸æ‰§è¡Œ
```

**4. å®ç°è„šæ‰‹æ¶å…·ä½“ä¸šåŠ¡**

è„šæ‰‹æ¶çš„å·¥ä½œè¿‡ç¨‹ï¼š

1. é€šè¿‡å‘½ä»¤è¡Œäº¤äº’è¯¢é—®ç”¨æˆ·é—®é¢˜

2. æ ¹æ®ç”¨æˆ·å›ç­”çš„ç»“æœç”Ÿæˆæ–‡ä»¶

```bash
# å®‰è£…å¿…è¦ä¾èµ–
yarn add inquirer ejs
# åˆ›å»ºæ¨¡æ¿æ–‡ä»¶ templates/...
```

```JS
#!/usr/bin/env node

const fs = require('fs')
const path = require('path')
const inquirer = require('inquirer')
const ejs = require('ejs')

inquirer.prompt([
  {
    type: 'input',
    name: 'name',
    message: 'Project name?'
  }
])
.then(anwsers => {
  // console.log(anwsers)
  // æ ¹æ®ç”¨æˆ·å›ç­”çš„ç»“æœç”Ÿæˆæ–‡ä»¶

  // æ¨¡æ¿ç›®å½•
  const tmplDir = path.join(__dirname, 'templates')
  // ç›®æ ‡ç›®å½•
  const destDir = process.cwd()

  // å°†æ¨¡æ¿ä¸‹çš„æ–‡ä»¶å…¨éƒ¨è½¬æ¢åˆ°ç›®æ ‡ç›®å½•
  fs.readdir(tmplDir, (err, files) => {
    if (err) throw err
    files.forEach(file => {
      // é€šè¿‡æ¨¡æ¿å¼•æ“æ¸²æŸ“æ–‡ä»¶
      ejs.renderFile(path.join(tmplDir, file), anwsers, (err, result) => {
        if (err) throw err

        // å°†ç»“æœå†™å…¥ç›®æ ‡æ–‡ä»¶è·¯å¾„
        fs.writeFileSync(path.join(destDir, file), result)
      })
    })
  })
})
```

**5. è¿è¡Œæµ‹è¯•**

1. è¿›å…¥æµ‹è¯•æ–‡ä»¶å¤¹
2. è¿è¡Œå‘½ä»¤ `scaffolding-sample`