## JavaScript 项目中的类型增强

JavaScript 项目中如何有更好的类型提示：JSDoc + [import-types](https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html#import-types)

https://www.typescriptlang.org/docs/handbook/type-checking-javascript-files.html

https://www.typescriptlang.org/play/index.html?useJavaScript=truee=4#example/jsdoc-support

### 类型检查

`@ts-check`

### 类型注解

- `@type`
- `@typedef`

```js
// 检查类型的错误
// @ts-check

/**
 * @summary 操作 DOM
 * @author zs
 * @param { HTMLDivElement } a1 要操作的div
 * @param { string } a2 字符串
 * @returns { HTMLDivElement } 这是一个dom对象
 */
function fn (a1, a2) {
  return a1
}
fn()

/** @type { string } */
let name
name = 18

/** @typedef { 'open' | 'closed' } Status  */
/** @type { Status } */
const s = 'open'
```

1. 配置文件类型
   - vue.config.js
   - webpack.config.js

```js
/** @type {import('@vue/cli-service').ProjectOptions} */
module.exports = {
}

/** @type {import('webpack').Configuration} */
module.exports = {
}
```

1. router 类型

```js
// Vue.js 3.0 中
/** @type { import('vue-router').RouteRecordRaw[] } */
const routes = []

// Vue.js 2.x 中
/** @type { import('vue-router').RouteConfig[] } */
const routes = []
```

1. store 类型

```js
// Vue.js 3.0 和 Vue.js 2.x 一样
/** @type { import('vuex').MutationTree<typeof import('./state').default> } */
const mutations = {
  add (state) {
  }
}

export default mutations
```

### 类型补充声明

- types.d.ts

插件的类型扩展，使用类型补充声明

```js
import { AxiosInstance } from 'axios'

declare module 'vue/types/vue' {
  interface Vue {
    readonly axios: AxiosInstance
  }
}
```

```js
import axios from 'axios'

export default {
  install (Vue) {
    const instance = axios.create({
      baseURL: 'http://127.0.0.1/api/v1',
      timeout: 10000
    })
    Vue.prototype.axios = instance
  }
}
```

