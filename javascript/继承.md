# ç»§æ‰¿çš„æ¦‚å¿µ

ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡çš„ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼æˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°å¤ç”¨ä»¥å‰çš„å¼€å‘ä»£ç ï¼Œç¼©çŸ­å¼€å‘çš„å‘¨æœŸã€æå‡å¼€å‘æ•ˆç‡ã€‚

ç»§æ‰¿åœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸­éƒ½å……å½“ç€è‡³å…³é‡è¦çš„è§’è‰²ï¼Œç‰¹åˆ«æ˜¯åœ¨ JavaScript ä¸­ï¼Œå®ƒå¤©ç”Ÿçš„çµæ´»æ€§ï¼Œä½¿åº”ç”¨åœºæ™¯æ›´åŠ ä¸°å¯Œã€‚JavaScript çš„ç»§æ‰¿ä¹Ÿç»å¸¸ä¼šåœ¨ç”¨åœ¨å‰ç«¯å·¥ç¨‹åŸºç¡€åº“çš„åº•å±‚æ­å»ºä¸Šé¢ã€‚

è¯´åˆ°ç»§æ‰¿çš„æ¦‚å¿µï¼Œé¦–å…ˆè¦è¯´ä¸€ä¸ªç»å…¸çš„ä¾‹å­ğŸŒ°ï¼šå…ˆå®šä¹‰ä¸€ä¸ªç±»ï¼ˆClassï¼‰å«æ±½è½¦ï¼Œæ±½è½¦çš„å±æ€§åŒ…æ‹¬é¢œè‰²ã€è½®èƒã€å“ç‰Œã€é€Ÿåº¦ã€æ’æ°”é‡ç­‰ï¼Œç”±æ±½è½¦è¿™ä¸ªç±»å¯ä»¥æ´¾ç”Ÿå‡ºâ€œè½¿è½¦â€å’Œâ€œè´§è½¦â€ä¸¤ä¸ªç±»ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨æ±½è½¦çš„åŸºç¡€å±æ€§ä¸Šï¼Œä¸ºè½¿è½¦æ·»åŠ ä¸€ä¸ªåå¤‡å¢ã€ç»™è´§è½¦æ·»åŠ ä¸€ä¸ªå¤§è´§ç®±ã€‚è¿™æ ·è½¿è½¦å’Œè´§è½¦å°±æ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯äºŒè€…éƒ½å±äºæ±½è½¦è¿™ä¸ªç±»ï¼Œè¿™æ ·ä»è¿™ä¸ªä¾‹å­ä¸­å°±èƒ½è¯¦ç»†è¯´æ˜æ±½è½¦ã€è½¿è½¦ä»¥åŠå¡è½¦ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ã€‚

ç»§æ‰¿å¯ä»¥ä½¿å¾—å­ç±»åˆ«å…·æœ‰çˆ¶ç±»çš„å„ç§æ–¹æ³•å’Œå±æ€§ï¼Œæ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­â€œè½¿è½¦â€ å’Œ â€œè´§è½¦â€ åˆ†åˆ«ç»§æ‰¿äº†æ±½è½¦çš„å±æ€§ï¼Œè€Œä¸éœ€è¦å†æ¬¡åœ¨â€œè½¿è½¦â€ä¸­å®šä¹‰æ±½è½¦å·²ç»æœ‰çš„å±æ€§ã€‚åœ¨â€œè½¿è½¦â€ç»§æ‰¿â€œæ±½è½¦â€çš„åŒæ—¶ï¼Œä¹Ÿå¯ä»¥é‡æ–°å®šä¹‰æ±½è½¦çš„æŸäº›å±æ€§ï¼Œå¹¶é‡å†™æˆ–è¦†ç›–æŸäº›å±æ€§å’Œæ–¹æ³•ï¼Œä½¿å…¶è·å¾—ä¸â€œæ±½è½¦â€è¿™ä¸ªçˆ¶ç±»ä¸åŒçš„å±æ€§å’Œæ–¹æ³•ã€‚



# JS å®ç°ç»§æ‰¿çš„å‡ ç§æ–¹å¼

## æ–¹å¼ä¸€ï¼š åŸå‹é“¾ç»§æ‰¿

> åŸå‹é“¾ç»§æ‰¿æ˜¯æ¯”è¾ƒå¸¸è§çš„ç»§æ‰¿æ–¹å¼ä¹‹ä¸€ï¼Œå…¶ä¸­æ¶‰åŠçš„æ„é€ å‡½æ•°ã€åŸå‹å’Œå®ä¾‹ï¼Œä¸‰è€…ä¹‹é—´å­˜åœ¨ç€ä¸€å®šçš„å…³ç³»ï¼Œå³æ¯ä¸€ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡åˆåŒ…å«ä¸€ä¸ªæŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆï¼Œè€Œå®ä¾‹åˆ™åŒ…å«ä¸€ä¸ªåŸå‹å¯¹è±¡çš„æŒ‡é’ˆ
>
> [å‚è€ƒå¤–é“¾]( https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain)

```js
function Parent1() {
    this.name = 'parent1';
    this.play = [1, 2, 3]
}
function Child1() {
    this.type = 'child2';
}
Child1.prototype = new Parent1();
console.log(new Child1());

var s1 = new Child1();
var s2 = new Child1();
s1.play.push(4);
console.log(s1.play, s2.play);
```

ğŸ“¢ **Attention:**

å› ä¸ºä¸¤ä¸ªå®ä¾‹ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªåŸå‹å¯¹è±¡ã€‚å®ƒä»¬çš„å†…å­˜ç©ºé—´æ˜¯å…±äº«çš„ï¼Œå½“ä¸€ä¸ªå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå¦å¤–ä¸€ä¸ªä¹Ÿéšä¹‹è¿›è¡Œäº†å˜åŒ–ï¼Œè¿™å°±æ˜¯ä½¿ç”¨åŸå‹é“¾ç»§æ‰¿æ–¹å¼çš„ä¸€ä¸ªç¼ºç‚¹ã€‚



## æ–¹å¼äºŒ: æ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆå€ŸåŠ© callï¼‰

```js
function Parent1(){
    this.name = 'parent1';
  }

Parent1.prototype.getName = function () {
    return this.name;
}

function Child1(){
    Parent1.call(this);
    this.type = 'child1'
}

let child = new Child1();
console.log(child);  // æ²¡é—®é¢˜
console.log(child.getName());  // ä¼šæŠ¥é”™
```

ğŸ“¢ **Attention**ï¼š

å®ƒä½¿çˆ¶ç±»çš„å¼•ç”¨å±æ€§ä¸ä¼šè¢«å…±äº«ï¼Œä¼˜åŒ–äº†ç¬¬ä¸€ç§ç»§æ‰¿æ–¹å¼çš„å¼Šç«¯ï¼›ä½†æ˜¯éšä¹‹è€Œæ¥çš„ç¼ºç‚¹ä¹Ÿæ¯”è¾ƒæ˜æ˜¾â€”â€”åªèƒ½ç»§æ‰¿çˆ¶ç±»çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•ï¼Œä¸èƒ½ç»§æ‰¿åŸå‹å±æ€§æˆ–è€…æ–¹æ³•ã€‚



## æ–¹å¼ä¸‰ï¼š ç»„åˆç»§æ‰¿ï¼ˆå‰ä¸¤ç§ç»„åˆï¼‰

```js
function Parent3 () {
    this.name = 'parent3';
    this.play = [1, 2, 3];
}

Parent3.prototype.getName = function () {
    return this.name;
}
function Child3() {
    // ç¬¬äºŒæ¬¡è°ƒç”¨ Parent3()
    Parent3.call(this);
    this.type = 'child3';
}

// ç¬¬ä¸€æ¬¡è°ƒç”¨ Parent3()
Child3.prototype = new Parent3();
// æ‰‹åŠ¨æŒ‚ä¸Šæ„é€ å™¨ï¼ŒæŒ‡å‘è‡ªå·±çš„æ„é€ å‡½æ•°
Child3.prototype.constructor = Child3;
var s3 = new Child3();
var s4 = new Child3();
s3.play.push(4);
console.log(s3.play, s4.play);  // ä¸äº’ç›¸å½±å“
console.log(s3.getName()); // æ­£å¸¸è¾“å‡º'parent3'
console.log(s4.getName()); // æ­£å¸¸è¾“å‡º'parent3'
```

ğŸ“¢ **Attention:**

é€šè¿‡æ³¨é‡Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ° Parent3 æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ˜¯æ”¹å˜Child3 çš„ prototype çš„æ—¶å€™ï¼Œç¬¬äºŒæ¬¡æ˜¯é€šè¿‡ call æ–¹æ³•è°ƒç”¨ Parent3 çš„æ—¶å€™ï¼Œé‚£ä¹ˆ Parent3 å¤šæ„é€ ä¸€æ¬¡å°±å¤šè¿›è¡Œäº†ä¸€æ¬¡æ€§èƒ½å¼€é”€ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸æ„¿çœ‹åˆ°çš„ã€‚



## **æ–¹å¼å››**ï¼šåŸå‹å¼ç»§æ‰¿ã€ES5ï¼š Object.create ã€‘

> Object.create æ–¹æ³•: 
>
> è¯¥æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€æ˜¯ç”¨ä½œæ–°å¯¹è±¡åŸå‹çš„å¯¹è±¡ã€äºŒæ˜¯ä¸ºæ–°å¯¹è±¡å®šä¹‰é¢å¤–å±æ€§çš„å¯¹è±¡ï¼ˆå¯é€‰å‚æ•°ï¼‰

```js
let parent4 = {
     name: "parent4",
     friends: ["p1", "p2", "p3"],
     getName: function() {
    	 return this.name;
     }
 };

let person4 = Object.create(parent4);
person4.name = "tom";
person4.friends.push("jerry");

let person5 = Object.create(parent4);
person5.friends.push("lucy");

console.log(person4.name);
console.log(person4.name === person4.getName());
console.log(person5.name);
console.log(person4.friends);
console.log(person5.friends);
```

ğŸ“¢ **Attention**ï¼š

ç¼ºç‚¹ï¼šå¤šä¸ªå®ä¾‹çš„å¼•ç”¨ç±»å‹å±æ€§æŒ‡å‘ç›¸åŒçš„å†…å­˜ï¼Œå­˜åœ¨ç¯¡æ”¹çš„å¯èƒ½



## **æ–¹å¼äº”**ï¼š å¯„ç”Ÿå¼ç»§æ‰¿

> ä½¿ç”¨åŸå‹å¼ç»§æ‰¿å¯ä»¥è·å¾—ä¸€ä»½ç›®æ ‡å¯¹è±¡çš„æµ…æ‹·è´ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªæµ…æ‹·è´çš„èƒ½åŠ›å†è¿›è¡Œå¢å¼ºï¼Œæ·»åŠ ä¸€äº›æ–¹æ³•ï¼Œè¿™æ ·çš„ç»§æ‰¿æ–¹å¼å°±å«ä½œå¯„ç”Ÿå¼ç»§æ‰¿ã€‚

```js
let parent5 = {
    name: "parent5",
    friends: ["p1", "p2", "p3"],
    getName: function() {
        return this.name;
    }
};

function clone(original) {
    let clone = Object.create(original);
    clone.getFriends = function() {
        return this.friends;
    };
    return clone;
}

let person5 = clone(parent5);

console.log(person5.getName());
console.log(person5.getFriends());
```

ğŸ“¢ **Attetion:**

ä»æœ€åçš„è¾“å‡ºç»“æœä¸­å¯ä»¥çœ‹åˆ°ï¼Œperson5 é€šè¿‡ clone çš„æ–¹æ³•ï¼Œå¢åŠ äº† getFriends çš„æ–¹æ³•ï¼Œä»è€Œä½¿ person5 è¿™ä¸ªæ™®é€šå¯¹è±¡åœ¨ç»§æ‰¿è¿‡ç¨‹ä¸­åˆå¢åŠ äº†ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™æ ·çš„ç»§æ‰¿æ–¹å¼å°±æ˜¯å¯„ç”Ÿå¼ç»§æ‰¿ã€‚

ä¼˜ç¼ºç‚¹åŒåŸå‹å¼ç»§æ‰¿



## **æ–¹å¼å…­**ï¼š å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿

> ç»“åˆç¬¬å››ç§ä¸­æåŠçš„ç»§æ‰¿æ–¹å¼ï¼Œè§£å†³æ™®é€šå¯¹è±¡çš„ç»§æ‰¿é—®é¢˜çš„ Object.create æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨å‰é¢è¿™å‡ ç§ç»§æ‰¿æ–¹å¼çš„ä¼˜ç¼ºç‚¹åŸºç¡€ä¸Šè¿›è¡Œæ”¹é€ ï¼Œå¾—å‡ºäº†å¯„ç”Ÿç»„åˆå¼çš„ç»§æ‰¿æ–¹å¼ï¼Œè¿™ä¹Ÿæ˜¯æ‰€æœ‰ç»§æ‰¿æ–¹å¼é‡Œé¢ç›¸å¯¹æœ€ä¼˜çš„ç»§æ‰¿æ–¹å¼
>
> è¿™ç§å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿æ–¹å¼ï¼ŒåŸºæœ¬å¯ä»¥è§£å†³å‰å‡ ç§ç»§æ‰¿æ–¹å¼çš„ç¼ºç‚¹ï¼Œè¾ƒå¥½åœ°å®ç°äº†ç»§æ‰¿æƒ³è¦çš„ç»“æœï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº†æ„é€ æ¬¡æ•°ï¼Œå‡å°‘äº†æ€§èƒ½çš„å¼€é”€

```js
function clone (parent, child) {
    // è¿™é‡Œæ”¹ç”¨ Object.create å°±å¯ä»¥å‡å°‘ç»„åˆç»§æ‰¿ä¸­å¤šè¿›è¡Œä¸€æ¬¡æ„é€ çš„è¿‡ç¨‹
    child.prototype = Object.create(parent.prototype);
    child.prototype.constructor = child;
}

function Parent6() {
    this.name = 'parent6';
    this.play = [1, 2, 3];
}
Parent6.prototype.getName = function () {
	return this.name;
}
function Child6() {
    Parent6.call(this);
    this.friends = 'child5';
}

clone(Parent6, Child6);

Child6.prototype.getFriends = function () {
	return this.friends;
}

let person6 = new Child6();
console.log(person6);
console.log(person6.getName());
console.log(person6.getFriends());
```



## **ES6 çš„ extends å…³é”®å­—å®ç°é€»è¾‘**

> ES6 æä¾›äº†ç»§æ‰¿å…³é”®å­—extends

æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ ES6 é‡Œçš„ extends çš„è¯­æ³•ç³–ï¼Œä½¿ç”¨å…³é”®è¯å¾ˆå®¹æ˜“ç›´æ¥å®ç° JavaScript çš„ç»§æ‰¿ï¼Œä½†æ˜¯å¦‚æœæƒ³æ·±å…¥äº†è§£ extends è¯­æ³•ç³–æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå°±å¾—æ·±å…¥ç ”ç©¶ extends çš„åº•å±‚é€»è¾‘ã€‚

æˆ‘ä»¬å…ˆçœ‹ä¸‹ç”¨åˆ©ç”¨ extends å¦‚ä½•ç›´æ¥å®ç°ç»§æ‰¿ï¼Œä»£ç å¦‚ä¸‹

```js
class Person {
  constructor(name) {
    this.name = name
  }
  // åŸå‹æ–¹æ³•
  // å³ Person.prototype.getName = function() { }
  // ä¸‹é¢å¯ä»¥ç®€å†™ä¸º getName() {...}
  getName = function () {
    console.log('Person:', this.name)
  }
}
class Gamer extends Person {
  constructor(name, age) {
    // å­ç±»ä¸­å­˜åœ¨æ„é€ å‡½æ•°ï¼Œåˆ™éœ€è¦åœ¨ä½¿ç”¨â€œthisâ€ä¹‹å‰é¦–å…ˆè°ƒç”¨ super()ã€‚
    super(name)
    this.age = age
  }
}
const asuna = new Gamer('Asuna', 20)
asuna.getName() // æˆåŠŸè®¿é—®åˆ°çˆ¶ç±»çš„æ–¹æ³•
```
å› ä¸ºæµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ï¼Œå¦‚æœé‡åˆ°ä¸æ”¯æŒ ES6 çš„æµè§ˆå™¨ï¼Œé‚£ä¹ˆå°±å¾—åˆ©ç”¨ babel è¿™ä¸ªç¼–è¯‘å·¥å…·ï¼Œå°† ES6 çš„ä»£ç ç¼–è¯‘æˆ ES5ï¼Œè®©ä¸€äº›ä¸æ”¯æŒæ–°è¯­æ³•çš„æµè§ˆå™¨ä¹Ÿèƒ½è¿è¡Œã€‚

æœ€å extends ç¼–è¯‘æˆäº†ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸‹è½¬è¯‘ä¹‹åçš„ä»£ç ç‰‡æ®µ
```js
function _possibleConstructorReturn (self, call) { 
		// ...
		return call && (typeof call === 'object' || typeof call === 'function') ? call : self; 
}
function _inherits (subClass, superClass) { 
    // è¿™é‡Œå¯ä»¥çœ‹åˆ°
	subClass.prototype = Object.create(superClass && superClass.prototype, { 
		constructor: { 
			value: subClass, 
			enumerable: false, 
			writable: true, 
			configurable: true 
		} 
	}); 
	if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; 
}

var Parent = function Parent () {
	// éªŒè¯æ˜¯å¦æ˜¯ Parent æ„é€ å‡ºæ¥çš„ this
	_classCallCheck(this, Parent);
};
var Child = (function (_Parent) {
	_inherits(Child, _Parent);
	function Child () {
		_classCallCheck(this, Child);
		return _possibleConstructorReturn(this, (Child.__proto__ || Object.getPrototypeOf(Child)).apply(this, arguments));
}
	return Child;
}(Parent));
```

ä»ä¸Šé¢ç¼–è¯‘å®Œæˆçš„æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå®ƒé‡‡ç”¨çš„ä¹Ÿæ˜¯å¯„ç”Ÿç»„åˆç»§æ‰¿æ–¹å¼ï¼Œå› æ­¤ä¹Ÿè¯æ˜äº†è¿™ç§æ–¹å¼æ˜¯è¾ƒä¼˜çš„è§£å†³ç»§æ‰¿çš„æ–¹å¼



# newã€applyã€callã€bind

## new åŸç†

new å…³é”®è¯çš„ä¸»è¦ä½œç”¨å°±æ˜¯æ‰§è¡Œä¸€ä¸ªæ„é€ å‡½æ•°ã€è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œåœ¨ new çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®æ„é€ å‡½æ•°çš„æƒ…å†µï¼Œæ¥ç¡®å®šæ˜¯å¦å¯ä»¥æ¥å—å‚æ•°çš„ä¼ é€’ã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€æ®µä»£ç æ¥çœ‹ä¸€ä¸ªç®€å•çš„ new çš„ä¾‹å­ã€‚

```js
function Person(){
   this.name = 'Jack';
}
var p = new Person(); 
console.log(p.name)  // Jack
```

ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œp æ˜¯ä¸€ä¸ªé€šè¿‡ person è¿™ä¸ªæ„é€ å‡½æ•°ç”Ÿæˆçš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡

**â­ï¸ new åœ¨è¿™ä¸ªç”Ÿæˆå®ä¾‹çš„è¿‡ç¨‹ä¸­å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤æ¥å®ç°:**

1. åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼›

2. å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ï¼ˆthis æŒ‡å‘æ–°å¯¹è±¡ï¼‰ï¼›

3. æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰ï¼›

4. è¿”å›æ–°å¯¹è±¡ã€‚

   

- å¦‚æœä¸ç”¨ new è¿™ä¸ªå…³é”®è¯ï¼Œç»“åˆä¸Šé¢çš„ä»£ç æ”¹é€ ä¸€ä¸‹ï¼Œå»æ‰ newï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæ ·çš„å˜åŒ–å‘¢ï¼Ÿ

  ```js
  function Person(){
    this.name = 'Jack';
  }
  var p = Person();
  console.log(p) // undefined
  console.log(name) // Jack
  console.log(p.name) // 'name' of undefined
  ```
  ä»ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ new è¿™ä¸ªå…³é”®è¯ï¼Œè¿”å›çš„ç»“æœå°±æ˜¯ undefinedã€‚å…¶ä¸­ç”±äº JavaScript ä»£ç åœ¨é»˜è®¤æƒ…å†µä¸‹ this çš„æŒ‡å‘æ˜¯ windowï¼Œé‚£ä¹ˆ name çš„è¾“å‡ºç»“æœå°±ä¸º Jackï¼Œè¿™æ˜¯ä¸€ç§ä¸å­˜åœ¨ new å…³é”®è¯çš„æƒ…å†µ

- å½“æ„é€ å‡½æ•°ä¸­æœ‰ return ä¸€ä¸ªå¯¹è±¡çš„æ“ä½œï¼Œç»“æœåˆä¼šæ˜¯ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿ

  ```js
  function Person(){
     this.name = 'Jack'; 
     return {age: 18}
  }
  var p = new Person(); 
  console.log(p)  // {age: 18}
  console.log(p.name) // undefined
  console.log(p.age) // 18
  ```

  é€šè¿‡è¿™æ®µä»£ç åˆå¯ä»¥çœ‹å‡ºï¼Œå½“æ„é€ å‡½æ•°æœ€å return å‡ºæ¥çš„æ˜¯ä¸€ä¸ªå’Œ this æ— å…³çš„å¯¹è±¡æ—¶ï¼Œnew å‘½ä»¤ä¼šç›´æ¥è¿”å›è¿™ä¸ªæ–°å¯¹è±¡ï¼Œè€Œä¸æ˜¯é€šè¿‡ new æ‰§è¡Œæ­¥éª¤ç”Ÿæˆçš„ this å¯¹è±¡ã€‚

  ä½†æ˜¯è¿™é‡Œè¦æ±‚æ„é€ å‡½æ•°å¿…é¡»æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœè¿”å›çš„ä¸æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆè¿˜æ˜¯ä¼šæŒ‰ç…§ new çš„å®ç°æ­¥éª¤ï¼Œè¿”å›æ–°ç”Ÿæˆçš„å¯¹è±¡ã€‚

  ```js
  function Person(){
     this.name = 'Jack'; 
     return 'tom';
  }
  var p = new Person(); 
  console.log(p)  // {name: 'Jack'}
  console.log(p.name) // Jack
  ```

  å¯ä»¥çœ‹å‡ºï¼Œå½“æ„é€ å‡½æ•°ä¸­ return çš„ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œé‚£ä¹ˆå®ƒè¿˜æ˜¯ä¼šæ ¹æ® new å…³é”®è¯çš„æ‰§è¡Œé€»è¾‘ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ˆç»‘å®šäº†æœ€æ–° thisï¼‰ï¼Œæœ€åè¿”å›å‡ºæ¥ã€‚

- **ğŸ“š æ€»ç»“ï¼š**
  new å…³é”®è¯æ‰§è¡Œä¹‹åæ€»æ˜¯ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¦ä¹ˆæ˜¯å®ä¾‹å¯¹è±¡ï¼Œè¦ä¹ˆæ˜¯ return è¯­å¥æŒ‡å®šçš„å¯¹è±¡

- [å‚è€ƒé“¾æ¥-1](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/new)
  [å‚è€ƒé“¾æ¥-2](https://www.tutorialsteacher.com/javascript/new-keyword-in-javascript)



## apply & call & bind åŸç†
callã€apply å’Œ bind æ˜¯æŒ‚åœ¨ Function å¯¹è±¡ä¸Šçš„ä¸‰ä¸ªæ–¹æ³•ï¼Œè°ƒç”¨è¿™ä¸‰ä¸ªæ–¹æ³•çš„å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š

```javascript
// func æ˜¯è¦è°ƒç”¨çš„å‡½æ•°ï¼ŒthisArg ä¸€èˆ¬ä¸º this æ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œåé¢çš„ param1ã€2 ä¸ºå‡½æ•° func çš„å¤šä¸ªå‚æ•°
func.call(thisArg, param1, param2, ...)
func.apply(thisArg, [param1,param2,...])
func.bind(thisArg, param1, param2, ...)
```
**ç›¸åŒç‚¹å’ŒåŒºåˆ«**

è¿™ä¸‰ä¸ªæ–¹æ³•å…±æœ‰çš„ã€æ¯”è¾ƒæ˜æ˜¾çš„ä½œç”¨å°±æ˜¯ï¼Œéƒ½å¯ä»¥æ”¹å˜å‡½æ•° func çš„ this æŒ‡å‘ã€‚
call å’Œ apply çš„åŒºåˆ«åœ¨äºï¼Œä¼ å‚çš„å†™æ³•ä¸åŒï¼šapply çš„ç¬¬ 2 ä¸ªå‚æ•°ä¸ºæ•°ç»„ï¼› call åˆ™æ˜¯ä»ç¬¬ 2 ä¸ªè‡³ç¬¬ N ä¸ªéƒ½æ˜¯ç»™ func çš„ä¼ å‚ï¼›è€Œ bind å’Œè¿™ä¸¤ä¸ªï¼ˆcallã€applyï¼‰åˆä¸åŒï¼Œbind è™½ç„¶æ”¹å˜äº† func çš„ this æŒ‡å‘ï¼Œä½†ä¸æ˜¯é©¬ä¸Šæ‰§è¡Œï¼Œè€Œè¿™ä¸¤ä¸ªï¼ˆcallã€applyï¼‰æ˜¯åœ¨æ”¹å˜äº†å‡½æ•°çš„ this æŒ‡å‘ä¹‹åç«‹é©¬æ‰§è¡Œ

```javascript
let a = {
  name: 'jack',
  getName: function(msg) {
    return msg + this.name;
  } 
}
let b = {
  name: 'lily'
}
console.log(a.getName('hello~'));  // hello~jack
console.log(a.getName.call(b, 'hi~'));  // hi~lily
console.log(a.getName.apply(b, ['hi~']))  // hi~lily
let name = a.getName.bind(b, 'hello~');
console.log(name());  // hello~lily
```

**æ–¹æ³•çš„åº”ç”¨åœºæ™¯**

- **åˆ¤æ–­æ•°æ®ç±»å‹**

  ç”¨ Object.prototype.toString æ¥åˆ¤æ–­ç±»å‹æ˜¯æœ€åˆé€‚çš„ï¼Œå€Ÿç”¨å®ƒæˆ‘ä»¬å‡ ä¹å¯ä»¥åˆ¤æ–­æ‰€æœ‰ç±»å‹çš„æ•°æ®ï¼Œ

  ```js
  function getType(obj){
    let type  = typeof obj;
    if (type !== "object") {
      return type;
    }
    return Object.prototype.toString.call(obj).replace(/^$/, '$1');
  }
  ```

  ç»“åˆä¸Šé¢è¿™æ®µä»£ç ï¼Œä»¥åŠåœ¨å‰é¢è®²çš„ call çš„æ–¹æ³•çš„ â€œå€Ÿç”¨â€ æ€è·¯ï¼Œé‚£ä¹ˆåˆ¤æ–­æ•°æ®ç±»å‹å°±æ˜¯å€Ÿç”¨äº† Object çš„åŸå‹é“¾ä¸Šçš„ toString æ–¹æ³•ï¼Œæœ€åè¿”å›ç”¨æ¥åˆ¤æ–­ä¼ å…¥çš„ obj çš„å­—ç¬¦ä¸²ï¼Œæ¥ç¡®å®šæœ€åçš„æ•°æ®ç±»å‹ã€‚

- **ç±»æ•°ç»„å€Ÿç”¨æ–¹æ³•**

  ç±»æ•°ç»„å› ä¸ºä¸æ˜¯çœŸæ­£çš„æ•°ç»„ï¼Œæ‰€æœ‰æ²¡æœ‰æ•°ç»„ç±»å‹ä¸Šè‡ªå¸¦çš„ç§ç§æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä¸€äº›æ–¹æ³•å»å€Ÿç”¨æ•°ç»„çš„æ–¹æ³•ï¼Œæ¯”å¦‚å€Ÿç”¨æ•°ç»„çš„ push æ–¹æ³•

  ```javascript
  var arrayLike = { 
    0: 'java',
    1: 'script',
    length: 2
  } 
  Array.prototype.push.call(arrayLike, 'jack', 'lily'); 
  console.log(typeof arrayLike); // 'object'
  console.log(arrayLike);
  // {0: "java", 1: "script", 2: "jack", 3: "lily", length: 4}
  ```
  arrayLike æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ¨¡æ‹Ÿæ•°ç»„çš„ä¸€ä¸ªç±»æ•°ç»„ã€‚ä»æ•°æ®ç±»å‹ä¸Šçœ‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ä»ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œç”¨ typeof æ¥åˆ¤æ–­è¾“å‡ºçš„æ˜¯ 'object'ï¼Œå®ƒè‡ªèº«æ˜¯ä¸ä¼šæœ‰æ•°ç»„çš„ push æ–¹æ³•çš„ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ç”¨ call çš„æ–¹æ³•æ¥å€Ÿç”¨ Array åŸå‹é“¾ä¸Šçš„ push æ–¹æ³•ï¼Œå¯ä»¥å®ç°ä¸€ä¸ªç±»æ•°ç»„çš„ push æ–¹æ³•ï¼Œç»™ arrayLike æ·»åŠ æ–°çš„å…ƒ

- **è·å–æ•°ç»„çš„æœ€å¤§ / æœ€å°å€¼**
  
  å¯ä»¥ç”¨ apply æ¥å®ç°æ•°ç»„ä¸­åˆ¤æ–­æœ€å¤§ / æœ€å°å€¼ï¼Œapply ç›´æ¥ä¼ é€’æ•°ç»„ä½œä¸ºè°ƒç”¨æ–¹æ³•çš„å‚æ•°ï¼Œä¹Ÿå¯ä»¥å‡å°‘ä¸€æ­¥å±•å¼€æ•°ç»„ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ Math.maxã€Math.min æ¥è·å–æ•°ç»„çš„æœ€å¤§å€¼ / æœ€å°å€¼
  
  ```javascript
  let arr = [13, 6, 10, 11, 16];
  const max = Math.max.apply(Math, arr); 
  const min = Math.min.apply(Math, arr);
   
  console.log(max);  // 16
  console.log(min);  // 6
  ```


- **ç»§æ‰¿**

  ç»§æ‰¿ä¸ newã€call å…±åŒå®ç°äº†å„ç§å„æ ·çš„ç»§æ‰¿æ–¹å¼



## æ‰‹å†™æ–¹æ³•

### new çš„å®ç°

new è¢«è°ƒç”¨åå¤§è‡´åšçš„å‡ ä»¶äº‹æƒ…

1. è®©å®ä¾‹å¯ä»¥è®¿é—®åˆ°ç§æœ‰å±æ€§ï¼›
2. è®©å®ä¾‹å¯ä»¥è®¿é—®æ„é€ å‡½æ•°åŸå‹ï¼ˆconstructor.prototypeï¼‰æ‰€åœ¨åŸå‹é“¾ä¸Šçš„å±æ€§ï¼›
3. æ„é€ å‡½æ•°è¿”å›çš„æœ€åç»“æœæ˜¯å¼•ç”¨æ•°æ®ç±»å‹ã€‚

```javascript
function _new(ctor, ...args) {
    if(typeof ctor !== 'function') {
      throw 'ctor must be a function';
    }
    let obj = new Object();
    obj.__proto__ = Object.create(ctor.prototype);
    let res = ctor.apply(obj,  [...args]);

    let isObject = typeof res === 'object' && typeof res !== null;
    let isFunction = typeof res === 'function';
    return isObect || isFunction ? res : obj;
};
```


### apply å’Œ call çš„å®ç°

```javascript
Function.prototype.call = function (context, ...args) {
  var context = context || window;
  context.fn = this;
  var result = eval('context.fn(...args)');
  delete context.fn
  return result;
}
Function.prototype.apply = function (context, args) {
  let context = context || window;
  context.fn = this;
  let result = eval('context.fn(...args)');
  delete context.fn
  return result;
}
```


### bind çš„å®ç°

> å®ç° bind çš„æ ¸å¿ƒåœ¨äºè¿”å›çš„æ—¶å€™éœ€è¦è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ•…è¿™é‡Œçš„ fbound éœ€è¦è¿”å›ï¼Œä½†æ˜¯åœ¨è¿”å›çš„è¿‡ç¨‹ä¸­åŸå‹é“¾å¯¹è±¡ä¸Šçš„å±æ€§ä¸èƒ½ä¸¢å¤±ã€‚å› æ­¤è¿™é‡Œéœ€è¦ç”¨Object.create æ–¹æ³•ï¼Œå°† this.prototype ä¸Šé¢çš„å±æ€§æŒ‚åˆ° fbound çš„åŸå‹ä¸Šé¢ï¼Œæœ€åå†è¿”å› fboundã€‚è¿™æ ·è°ƒç”¨ bind æ–¹æ³•æ¥æ”¶åˆ°å‡½æ•°çš„å¯¹è±¡ï¼Œå†é€šè¿‡æ‰§è¡Œæ¥æ”¶çš„å‡½æ•°ï¼Œå³å¯å¾—åˆ°æƒ³è¦çš„ç»“æœ

```javascript
Function.prototype.bind = function (context, ...args) {
    if (typeof this !== "function") {
      throw new Error("this must be a function");
    }
    var self = this;
    var fbound = function () {
        self.apply(this instanceof self ? this : context, args.concat(Array.prototype.slice.call(arguments)));
    }
    if(this.prototype) {
      fbound.prototype = Object.create(this.prototype);
    }
    return fbound;
}
```


## applyã€callã€bind æ–¹æ³•æ€»ç»“

| æ–¹æ³•/ç‰¹å¾ | call             | apply            | bind             |
| --------- | ---------------- | ---------------- | ---------------- |
| æ–¹æ³•å‚æ•°  | å¤šä¸ª             | å•ä¸ªæ•°ç»„         | å¤šä¸ª             |
| æ–¹æ³•åŠŸèƒ½  | å‡½æ•°è°ƒç”¨æ”¹å˜this | å‡½æ•°è°ƒç”¨æ”¹å˜this | å‡½æ•°è°ƒç”¨æ”¹å˜this |
| è¿”å›ç»“æœ  | ç›´æ¥æ‰§è¡Œ         | ç›´æ¥æ‰§è¡Œ         | è¿”å›å¾…æ‰§è¡Œå‚æ•°   |